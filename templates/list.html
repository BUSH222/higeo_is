{% extends "base.html" %}

{% block title %}{{page.title}}{% endblock %}

{% block content %}
<div class="container mt-3">
    <div class="results-box p-3">
        <h5 class="mb-2 mt-3 text-center result-counter" style="font-size: 1.5rem;">{{page.heading}}</h5>
        <div class="row">
            <div class="col-12">
                {% if result_use_pagination %}
                    <div class="row">
                        {% set grouped_results = {} %}
                        {% for item in results %}
                            {% set first_letter = item[2][0] %}
                            {% if first_letter not in grouped_results %}
                                {% if grouped_results.update({first_letter: []}) %}{% endif %}
                            {% endif %}
                            {% if grouped_results[first_letter].append(item) %}{% endif %}
                        {% endfor %}
                        
                        {% for letter, items in grouped_results.items() %}
                            <div class="col-12">
                                <h3 class="mt-2 mb-1">{{ letter }}</h3>
                            </div>
                            
                            {% set num_items = items|length %}
                            {% set num_cols = 4 %}
                            {% set items_per_col = ((num_items + num_cols - 1) // num_cols)|int %}
                            
                            {% for col in range(num_cols) %}
                                <div class="col-12 col-lg-3">
                                    {% for i in range(col * items_per_col, (col + 1) * items_per_col) %}
                                        {% if i < num_items %}
                                            <div class="result-item mb-1">
                                                <a href="/view?type={{ items[i][0] }}&id={{ items[i][1] }}">{{ items[i][2] }}</a>
                                            </div>
                                        {% endif %}
                                    {% endfor %}
                                </div>
                            {% endfor %}
                        {% endfor %}
                    </div>
                {% else %}
                    {% set num_items = results|length %}
                    {% set num_cols = 4 %}
                    {% set items_per_col = ((num_items + num_cols - 1) // num_cols)|int %}
                    
                    <div class="row">
                        {% for col in range(num_cols) %}
                            <div class="col-12 col-lg-3">
                                {% for i in range(col * items_per_col, (col + 1) * items_per_col) %}
                                    {% if i < num_items %}
                                        <div class="result-item mb-1">
                                            <a href="/view?type={{ results[i][0] }}&id={{ results[i][1] }}">{{ results[i][2] }}</a>
                                        </div>
                                    {% endif %}
                                {% endfor %}
                            </div>
                        {% endfor %}
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}